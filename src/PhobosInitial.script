%General Mission Analysis Tool(GMAT) Script
%Created: 2020-06-07 15:22:40


%----------------------------------------
%---------- User-Defined Celestial Bodies
%----------------------------------------

Create Moon Phobos;
GMAT Phobos.NAIFId = 401;
GMAT Phobos.OrbitSpiceKernelName = {'C:\Users\Chris\AppData\Local\GMAT\R2018a\data\planetary_ephem\spk\mar097.bsp'};
GMAT Phobos.OrbitColor = Tan;
GMAT Phobos.TargetColor = DarkGray;
GMAT Phobos.EquatorialRadius = 13.5;
GMAT Phobos.Flattening = 0.3185185185185186;
GMAT Phobos.Mu = 0.0007030934;
GMAT Phobos.PosVelSource = 'SPICE';
GMAT Phobos.CentralBody = 'Mars';
GMAT Phobos.RotationDataSource = 'IAUSimplified';
GMAT Phobos.OrientationEpoch = 21545;
GMAT Phobos.SpinAxisRAConstant = 317.67071657;
GMAT Phobos.SpinAxisRARate = 0.10844326;
GMAT Phobos.SpinAxisDECConstant = 52.88627266;
GMAT Phobos.SpinAxisDECRate = -0.06134706;
GMAT Phobos.RotationConstant = 35.1877444;
GMAT Phobos.RotationRate = 1128.84475928;
GMAT Phobos.TextureMapFileName = 'C:\Users\Chris\AppData\Local\GMAT\R2018a\data\graphics\texture\phobos_albedo.jpg';
GMAT Phobos.3DModelFile = 'C:\Users\Chris\AppData\Local\GMAT\R2018a\data\graphics\models\phobos.3DS';
GMAT Phobos.3DModelOffsetX = 0;
GMAT Phobos.3DModelOffsetY = 0;
GMAT Phobos.3DModelOffsetZ = 0;
GMAT Phobos.3DModelRotationX = 0;
GMAT Phobos.3DModelRotationY = 90;
GMAT Phobos.3DModelRotationZ = 90;
GMAT Phobos.3DModelScale = 1;

%----------------------------------------
%---------- Spacecraft
%----------------------------------------

Create Spacecraft PhobosProxy;
GMAT PhobosProxy.DateFormat = UTCGregorian;
GMAT PhobosProxy.Epoch = '01 Aug 2025 01:00:00.000';
GMAT PhobosProxy.CoordinateSystem = MarsInertial;
GMAT PhobosProxy.DisplayStateType = Cartesian;
GMAT PhobosProxy.X = 9127.931584945434;
GMAT PhobosProxy.Y = -2611.472995164269;
GMAT PhobosProxy.Z = -168.1209788313199;
GMAT PhobosProxy.VX = 0.5644805983655178;
GMAT PhobosProxy.VY = 2.033781123837515;
GMAT PhobosProxy.VZ = 0.0120589048637697;
GMAT PhobosProxy.DryMass = 10;
GMAT PhobosProxy.Cd = 2.2;
GMAT PhobosProxy.Cr = 1.8;
GMAT PhobosProxy.DragArea = 15;
GMAT PhobosProxy.SRPArea = 1;
GMAT PhobosProxy.NAIFId = -10004001;
GMAT PhobosProxy.NAIFIdReferenceFrame = -9004001;
GMAT PhobosProxy.OrbitColor = Red;
GMAT PhobosProxy.TargetColor = Teal;
GMAT PhobosProxy.OrbitErrorCovariance = [ 1e+070 0 0 0 0 0 ; 0 1e+070 0 0 0 0 ; 0 0 1e+070 0 0 0 ; 0 0 0 1e+070 0 0 ; 0 0 0 0 1e+070 0 ; 0 0 0 0 0 1e+070 ];
GMAT PhobosProxy.CdSigma = 1e+070;
GMAT PhobosProxy.CrSigma = 1e+070;
GMAT PhobosProxy.Id = 'SatId';
GMAT PhobosProxy.Attitude = CoordinateSystemFixed;
GMAT PhobosProxy.SPADSRPScaleFactor = 1;
GMAT PhobosProxy.AttitudeDisplayStateType = 'Quaternion';
GMAT PhobosProxy.AttitudeRateDisplayStateType = 'AngularVelocity';
GMAT PhobosProxy.AttitudeCoordinateSystem = MarsInertial;
GMAT PhobosProxy.EulerAngleSequence = '321';




%----------------------------------------
%---------- ForceModels
%----------------------------------------

Create ForceModel MarsProp_ForceModel;
GMAT MarsProp_ForceModel.CentralBody = Mars;
GMAT MarsProp_ForceModel.PrimaryBodies = {Mars};
GMAT MarsProp_ForceModel.PointMasses = {Jupiter, Sun};
GMAT MarsProp_ForceModel.Drag = None;
GMAT MarsProp_ForceModel.SRP = On;
GMAT MarsProp_ForceModel.RelativisticCorrection = Off;
GMAT MarsProp_ForceModel.ErrorControl = RSSStep;
GMAT MarsProp_ForceModel.GravityField.Mars.Degree = 20;
GMAT MarsProp_ForceModel.GravityField.Mars.Order = 20;
GMAT MarsProp_ForceModel.GravityField.Mars.StmLimit = 100;
GMAT MarsProp_ForceModel.GravityField.Mars.PotentialFile = 'Mars50c.cof';
GMAT MarsProp_ForceModel.GravityField.Mars.TideModel = 'None';
GMAT MarsProp_ForceModel.SRP.Flux = 1367;
GMAT MarsProp_ForceModel.SRP.SRPModel = Spherical;
GMAT MarsProp_ForceModel.SRP.Nominal_Sun = 149597870.691;

%----------------------------------------
%---------- Propagators
%----------------------------------------

Create Propagator MarsProp;
GMAT MarsProp.FM = MarsProp_ForceModel;
GMAT MarsProp.Type = PrinceDormand78;
GMAT MarsProp.InitialStepSize = 60;
GMAT MarsProp.Accuracy = 1e-012;
GMAT MarsProp.MinStep = 0;
GMAT MarsProp.MaxStep = 3600;
GMAT MarsProp.MaxStepAttempts = 50;
GMAT MarsProp.StopIfAccuracyIsViolated = true;

%----------------------------------------
%---------- Coordinate Systems
%----------------------------------------

Create CoordinateSystem MarsPhobosRotating;
GMAT MarsPhobosRotating.Origin = Mars;
GMAT MarsPhobosRotating.Axes = ObjectReferenced;
GMAT MarsPhobosRotating.XAxis = R;
GMAT MarsPhobosRotating.ZAxis = N;
GMAT MarsPhobosRotating.Primary = Mars;
GMAT MarsPhobosRotating.Secondary = Phobos;

Create CoordinateSystem MarsInertial;
GMAT MarsInertial.Origin = Mars;
GMAT MarsInertial.Axes = BodyInertial;

%----------------------------------------
%---------- Subscribers
%----------------------------------------

Create ReportFile PhobosReport;
GMAT PhobosReport.SolverIterations = Current;
GMAT PhobosReport.UpperLeft = [ 0 0 ];
GMAT PhobosReport.Size = [ 0 0 ];
GMAT PhobosReport.RelativeZOrder = 0;
GMAT PhobosReport.Maximized = false;
GMAT PhobosReport.Filename = 'PhobosOrbit.txt';
GMAT PhobosReport.Precision = 16;
GMAT PhobosReport.WriteHeaders = true;
GMAT PhobosReport.LeftJustify = On;
GMAT PhobosReport.ZeroFill = Off;
GMAT PhobosReport.FixedWidth = true;
GMAT PhobosReport.Delimiter = ' ';
GMAT PhobosReport.ColumnWidth = 23;
GMAT PhobosReport.WriteReport = true;

Create OrbitView MarsOrbitView;
GMAT MarsOrbitView.SolverIterations = Current;
GMAT MarsOrbitView.UpperLeft = [ 0.002941176470588235 0 ];
GMAT MarsOrbitView.Size = [ 0.8 0.85 ];
GMAT MarsOrbitView.RelativeZOrder = 256;
GMAT MarsOrbitView.Maximized = false;
GMAT MarsOrbitView.Add = {PhobosProxy, Mars, Phobos};
GMAT MarsOrbitView.CoordinateSystem = MarsInertial;
GMAT MarsOrbitView.DrawObject = [ true true true ];
GMAT MarsOrbitView.DataCollectFrequency = 1;
GMAT MarsOrbitView.UpdatePlotFrequency = 50;
GMAT MarsOrbitView.NumPointsToRedraw = 0;
GMAT MarsOrbitView.ShowPlot = true;
GMAT MarsOrbitView.MaxPlotPoints = 20000;
GMAT MarsOrbitView.ShowLabels = true;
GMAT MarsOrbitView.ViewPointReference = Mars;
GMAT MarsOrbitView.ViewPointVector = [ 0 0 30000 ];
GMAT MarsOrbitView.ViewDirection = Mars;
GMAT MarsOrbitView.ViewScaleFactor = 1;
GMAT MarsOrbitView.ViewUpCoordinateSystem = MarsInertial;
GMAT MarsOrbitView.ViewUpAxis = Z;
GMAT MarsOrbitView.EclipticPlane = Off;
GMAT MarsOrbitView.XYPlane = Off;
GMAT MarsOrbitView.WireFrame = Off;
GMAT MarsOrbitView.Axes = On;
GMAT MarsOrbitView.Grid = Off;
GMAT MarsOrbitView.SunLine = Off;
GMAT MarsOrbitView.UseInitialView = On;
GMAT MarsOrbitView.StarCount = 7000;
GMAT MarsOrbitView.EnableStars = Off;
GMAT MarsOrbitView.EnableConstellations = Off;


%----------------------------------------
%---------- Mission Sequence
%----------------------------------------

BeginMissionSequence;
Propagate 'Prop 1 Minute' MarsProp(PhobosProxy) {PhobosProxy.ElapsedSecs = 3600};
Report 'Phobos Orbit Report' PhobosReport Phobos.UTCGregorian Phobos.MarsInertial.X Phobos.MarsInertial.Y Phobos.MarsInertial.Z Phobos.MarsInertial.VX Phobos.MarsInertial.VY Phobos.MarsInertial.VZ;
